Optimize loops
add execution time monitoring